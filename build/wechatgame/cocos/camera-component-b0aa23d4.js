System.register(["./fog-c82f3158.js","./screen-b918b2af.js"],(function(t){"use strict";var e,r,i,o,a,n,c,s,h,p,_,u,l,f,y,m,g,b,d,w,v,T,O,S,x,D,j,C,z,P,k,A,E;return{setters:[function(t){e=t.cW,r=t.dw,i=t.ab,o=t.eQ,a=t.eY,n=t.ei,c=t.e2,s=t.eS,h=t.eN,p=t.g0,_=t.es,u=t.l,l=t.dg,f=t.eM,y=t.fz,m=t.eX,g=t.eT,b=t.fV,d=t.fD,w=t.fA,v=t.f3,T=t.ek,O=t.fB,S=t.d8,x=t.d6,D=t.fZ},function(t){j=t.a,C=t.C,z=t.b,P=t.d,k=t.c,A=t.S,E=t.v}],execute:function(){var F,H,I,L,W,N,R,M,V,Y,B,X,U,K,Q,Z,q,G,J,$,tt,et,rt,it,ot,at,nt,ct,st,ht,pt,_t,ut,lt,ft,yt,mt,gt,bt,dt,wt,vt,Tt,Ot,St,xt,Dt,jt,Ct,zt,Pt,kt,At,Et,Ft,Ht,It,Lt,Wt,Nt,Rt,Mt,Vt,Yt,Bt,Xt,Ut,Kt=new e,Qt=r(j),Zt=r(C),qt=r(z),Gt=r(P),Jt=r(k),$t=r({SKYBOX:A|i.DEPTH_STENCIL,SOLID_COLOR:i.ALL,DEPTH_ONLY:i.DEPTH_STENCIL,DONT_CLEAR:i.NONE}),te=t("C",(F=o("cc.Camera"),H=m(),I=g(),L=b(),W=d(),N=a(n.BitMask),R=b(),M=d(),V=a($t),Y=b(),B=d(),X=b(),U=d(),K=b(),Q=d(),Z=b(),q=d(),G=a(Qt),J=b(),$=d(),tt=a(Zt),et=b(),rt=d(),it=b(),ot=d(),at=b(),nt=d(),ct=b(),st=d(),ht=b(),pt=d(),_t=a(qt),ut=b(),lt=d(),ft=a(Gt),yt=b(),mt=d(),gt=a(Jt),bt=b(),dt=d(),wt=b(),vt=d(),Tt=a(c),Ot=b(),St=d(),F(xt=H(xt=I(xt=s((Ut=Xt=function(t){function r(){for(var e,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return e=t.call.apply(t,[this].concat(i))||this,w(e,"_projection",jt,v(e)),w(e,"_priority",Ct,v(e)),w(e,"_fov",zt,v(e)),w(e,"_fovAxis",Pt,v(e)),w(e,"_orthoHeight",kt,v(e)),w(e,"_near",At,v(e)),w(e,"_far",Et,v(e)),w(e,"_color",Ft,v(e)),w(e,"_depth",Ht,v(e)),w(e,"_stencil",It,v(e)),w(e,"_clearFlags",Lt,v(e)),w(e,"_rect",Wt,v(e)),w(e,"_aperture",Nt,v(e)),w(e,"_shutter",Rt,v(e)),w(e,"_iso",Mt,v(e)),w(e,"_screenScale",Vt,v(e)),w(e,"_visibility",Yt,v(e)),w(e,"_targetTexture",Bt,v(e)),e._camera=null,e._inEditorMode=!1,e._flows=void 0,e}h(r,t);var i=r.prototype;return i.onLoad=function(){this._createCamera()},i.onEnable=function(){this.node.hasChangedFlags|=p.POSITION,this._camera&&this._attachToScene()},i.onDisable=function(){this._camera&&this._detachFromScene()},i.onDestroy=function(){this._camera&&(this._camera.destroy(),this._camera=null),this._targetTexture&&this._targetTexture.off("resize")},i.screenPointToRay=function(t,e,r){return r||(r=_.create()),this._camera&&this._camera.screenPointToRay(r,t,e),r},i.worldToScreen=function(t,r){return r||(r=new e),this._camera&&this._camera.worldToScreen(r,t),r},i.screenToWorld=function(t,e){return e||(e=this.node.getWorldPosition()),this._camera&&this._camera.screenToWorld(e,t),e},i.convertToUINode=function(t,r,i){if(i||(i=new e),!this._camera)return i;this.worldToScreen(t,Kt);var o=r.getComponent("cc.UITransform"),a=E.getVisibleSize(),n=Kt.x-.5*this._camera.width,c=Kt.y-.5*this._camera.height;return Kt.x=n/u.view.getScaleX()+.5*a.width,Kt.y=c/u.view.getScaleY()+.5*a.height,o&&o.convertToNodeSpaceAR(Kt,i),i},i._createCamera=function(){this._camera||(this._camera=u.director.root.createCamera(),this._camera.initialize({name:this.node.name,node:this.node,projection:this._projection,window:this._inEditorMode?u.director.root&&u.director.root.mainWindow:u.director.root&&u.director.root.tempWindow,priority:this._priority}),this._camera.viewport=this._rect,this._camera.fovAxis=this._fovAxis,this._camera.fov=l(this._fov),this._camera.orthoHeight=this._orthoHeight,this._camera.nearClip=this._near,this._camera.farClip=this._far,this._camera.clearColor=this._color,this._camera.clearDepth=this._depth,this._camera.clearStencil=this._stencil,this._camera.clearFlag=this._clearFlags,this._camera.visibility=this._visibility,this._camera.aperture=this._aperture,this._camera.shutter=this._shutter,this._camera.iso=this._iso),this._updateTargetTexture()},i._attachToScene=function(){this.node.scene&&this._camera&&(this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera),this._getRenderScene().addCamera(this._camera))},i._detachFromScene=function(){this._camera&&this._camera.scene&&this._camera.scene.removeCamera(this._camera)},i._chechTargetTextureEvent=function(t){var e=this;t&&t.off("resize"),this._targetTexture&&this._targetTexture.on("resize",(function(t){e._camera&&e._camera.setFixedSize(t.width,t.height)}),this)},i._updateTargetTexture=function(){if(this._camera&&this._targetTexture){var t=this._targetTexture.window;this._camera.changeTargetWindow(t),this._camera.setFixedSize(t.width,t.height)}},f(r,[{key:"camera",get:function(){return this._camera}},{key:"priority",get:function(){return this._priority},set:function(t){this._priority=t,this._camera&&(this._camera.priority=t)}},{key:"visibility",get:function(){return this._visibility},set:function(t){this._visibility=t,this._camera&&(this._camera.visibility=t)}},{key:"clearFlags",get:function(){return this._clearFlags},set:function(t){this._clearFlags=t,this._camera&&(this._camera.clearFlag=t)}},{key:"clearColor",get:function(){return this._color},set:function(t){this._color.set(t),this._camera&&(this._camera.clearColor=this._color)}},{key:"clearDepth",get:function(){return this._depth},set:function(t){this._depth=t,this._camera&&(this._camera.clearDepth=t)}},{key:"clearStencil",get:function(){return this._stencil},set:function(t){this._stencil=t,this._camera&&(this._camera.clearStencil=t)}},{key:"projection",get:function(){return this._projection},set:function(t){this._projection=t,this._camera&&(this._camera.projectionType=t)}},{key:"fovAxis",get:function(){return this._fovAxis},set:function(t){t!==this._fovAxis&&(this._fovAxis=t,this._camera&&(this._camera.fovAxis=t,t===C.VERTICAL?this.fov=this._fov*this._camera.aspect:this.fov=this._fov/this._camera.aspect))}},{key:"fov",get:function(){return this._fov},set:function(t){this._fov=t,this._camera&&(this._camera.fov=l(t))}},{key:"orthoHeight",get:function(){return this._orthoHeight},set:function(t){this._orthoHeight=t,this._camera&&(this._camera.orthoHeight=t)}},{key:"near",get:function(){return this._near},set:function(t){this._near=t,this._camera&&(this._camera.nearClip=t)}},{key:"far",get:function(){return this._far},set:function(t){this._far=t,this._camera&&(this._camera.farClip=t)}},{key:"aperture",get:function(){return this._aperture},set:function(t){this._aperture=t,this._camera&&(this._camera.aperture=t)}},{key:"shutter",get:function(){return this._shutter},set:function(t){this._shutter=t,this._camera&&(this._camera.shutter=t)}},{key:"iso",get:function(){return this._iso},set:function(t){this._iso=t,this._camera&&(this._camera.iso=t)}},{key:"rect",get:function(){return this._rect},set:function(t){this._rect=t,this._camera&&(this._camera.viewport=t)}},{key:"targetTexture",get:function(){return this._targetTexture},set:function(t){if(this._targetTexture!==t){var e=this._targetTexture;this._targetTexture=t,this._chechTargetTextureEvent(e),this._updateTargetTexture(),!t&&this._camera&&(this._camera.changeTargetWindow(null),this._camera.isWindowSize=!0)}}},{key:"screenScale",get:function(){return this._screenScale},set:function(t){this._screenScale=t,this._camera&&(this._camera.screenScale=t)}},{key:"inEditorMode",get:function(){return this._inEditorMode},set:function(t){this._inEditorMode=t,this._camera&&this._camera.changeTargetWindow(t?u.director.root&&u.director.root.mainWindow:u.director.root&&u.director.root.tempWindow)}}]),r}(T),Xt.ProjectionType=Qt,Xt.FOVAxis=Zt,Xt.ClearFlag=$t,Xt.Aperture=qt,Xt.Shutter=Gt,Xt.ISO=Jt,jt=y((Dt=Ut).prototype,"_projection",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Qt.PERSPECTIVE}}),Ct=y(Dt.prototype,"_priority",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),zt=y(Dt.prototype,"_fov",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 45}}),Pt=y(Dt.prototype,"_fovAxis",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Zt.VERTICAL}}),kt=y(Dt.prototype,"_orthoHeight",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),At=y(Dt.prototype,"_near",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Et=y(Dt.prototype,"_far",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1e3}}),Ft=y(Dt.prototype,"_color",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new S("#333333")}}),Ht=y(Dt.prototype,"_depth",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),It=y(Dt.prototype,"_stencil",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Lt=y(Dt.prototype,"_clearFlags",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return $t.SOLID_COLOR}}),Wt=y(Dt.prototype,"_rect",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new x(0,0,1,1)}}),Nt=y(Dt.prototype,"_aperture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return qt.F16_0}}),Rt=y(Dt.prototype,"_shutter",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Gt.D125}}),Mt=y(Dt.prototype,"_iso",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Jt.ISO100}}),Vt=y(Dt.prototype,"_screenScale",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),Yt=y(Dt.prototype,"_visibility",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return D}}),Bt=y(Dt.prototype,"_targetTexture",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),y(Dt.prototype,"priority",[L,W],Object.getOwnPropertyDescriptor(Dt.prototype,"priority"),Dt.prototype),y(Dt.prototype,"visibility",[N,R,M],Object.getOwnPropertyDescriptor(Dt.prototype,"visibility"),Dt.prototype),y(Dt.prototype,"clearFlags",[V,Y,B],Object.getOwnPropertyDescriptor(Dt.prototype,"clearFlags"),Dt.prototype),y(Dt.prototype,"clearColor",[X,U],Object.getOwnPropertyDescriptor(Dt.prototype,"clearColor"),Dt.prototype),y(Dt.prototype,"clearDepth",[K,Q],Object.getOwnPropertyDescriptor(Dt.prototype,"clearDepth"),Dt.prototype),y(Dt.prototype,"clearStencil",[Z,q],Object.getOwnPropertyDescriptor(Dt.prototype,"clearStencil"),Dt.prototype),y(Dt.prototype,"projection",[G,J,$],Object.getOwnPropertyDescriptor(Dt.prototype,"projection"),Dt.prototype),y(Dt.prototype,"fovAxis",[tt,et,rt],Object.getOwnPropertyDescriptor(Dt.prototype,"fovAxis"),Dt.prototype),y(Dt.prototype,"fov",[it,ot],Object.getOwnPropertyDescriptor(Dt.prototype,"fov"),Dt.prototype),y(Dt.prototype,"orthoHeight",[at,nt],Object.getOwnPropertyDescriptor(Dt.prototype,"orthoHeight"),Dt.prototype),y(Dt.prototype,"near",[ct,st],Object.getOwnPropertyDescriptor(Dt.prototype,"near"),Dt.prototype),y(Dt.prototype,"far",[ht,pt],Object.getOwnPropertyDescriptor(Dt.prototype,"far"),Dt.prototype),y(Dt.prototype,"aperture",[_t,ut,lt],Object.getOwnPropertyDescriptor(Dt.prototype,"aperture"),Dt.prototype),y(Dt.prototype,"shutter",[ft,yt,mt],Object.getOwnPropertyDescriptor(Dt.prototype,"shutter"),Dt.prototype),y(Dt.prototype,"iso",[gt,bt,dt],Object.getOwnPropertyDescriptor(Dt.prototype,"iso"),Dt.prototype),y(Dt.prototype,"rect",[wt,vt],Object.getOwnPropertyDescriptor(Dt.prototype,"rect"),Dt.prototype),y(Dt.prototype,"targetTexture",[Tt,Ot,St],Object.getOwnPropertyDescriptor(Dt.prototype,"targetTexture"),Dt.prototype),xt=Dt))||xt)||xt)||xt)||xt));u.Camera=te}}}));
